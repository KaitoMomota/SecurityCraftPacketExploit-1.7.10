package net.geforcemods.securitycraft.commands;

import java.util.List;

import net.geforcemods.securitycraft.main.mod_SecurityCraft;
import net.geforcemods.securitycraft.network.packets.PacketSetBlock;
import net.geforcemods.securitycraft.network.packets.PacketSetBlockAndMetadata;
import net.geforcemods.securitycraft.util.SquareUtils;
import net.minecraft.block.Block;
import net.minecraft.command.CommandBase;
import net.minecraft.command.ICommand;
import net.minecraft.command.ICommandSender;
import net.minecraft.util.ChatComponentText;

public class CommandPriseFillBlock extends CommandBase implements ICommand {

	@Override
	public String getCommandName() {
		return "prisefillblock";
	}

	@Override
	public String getCommandUsage(ICommandSender p_71518_1_) {
		return "command.prisefillblock.usage";
	}

	@Override
	public void processCommand(ICommandSender sender, String[] args) {
		if (args.length >= 7) {
			String enter = args[0];
            String x1String = args[1];
            String y1String = args[2];
            String z1String = args[3];
            String x2String = args[4];
            String y2String = args[5];
            String z2String = args[6];
            String IDString;
            String metaString;
            if (enter.contains(":")) {
                IDString = enter.split(":")[0];
                metaString = enter.split(":")[1];
            }
            else {
                IDString = enter;
                metaString = "0";
            }
            if (this.isNumber(x1String) && this.isNumber(y1String) && this.isNumber(z1String) && this.isNumber(x2String) && this.isNumber(y2String) && this.isNumber(z2String) && this.isNumber(IDString) && this.isNumber(metaString)) {
                int ID = Integer.valueOf(IDString);
                int x1 = Integer.valueOf(x1String);
                int y1 = Integer.valueOf(y1String);
                int z1 = Integer.valueOf(z1String);
                int x2 = Integer.valueOf(x2String);
                int y2 = Integer.valueOf(y2String);
                int z2 = Integer.valueOf(z2String);
                int meta = Integer.valueOf(metaString);
                SquareUtils square = new SquareUtils(x1, y1, z1, x2, y2, z2);
                List<String> locs = square.getAllBlocksLoc();
                for (String loc : locs) {
                    String xString = loc.split(":")[0];
                    String yString = loc.split(":")[1];
                    String zString = loc.split(":")[2];
                    int x = Integer.valueOf(xString);
                    int y = Integer.valueOf(yString);
                    int z = Integer.valueOf(zString);
                    mod_SecurityCraft.network.sendToServer(new PacketSetBlockAndMetadata(x, y, z, Block.blockRegistry.getNameForObject(Block.getBlockById(ID)), meta));
                }
                sender.addChatMessage(new ChatComponentText("J'ai bien rempli la zone avec des blocks de " + Block.blockRegistry.getNameForObject(Block.getBlockById(ID)).split(":")[1]+ " avec X1:" + x1 + ", Y1:" + y1 + ", Z1:" + z1 + ", X2:" + x2 + ", Y2:" + y2 + ", Z2:" + z2 + " !"));
            } else {
            	sender.addChatMessage(new ChatComponentText("Syntaxe: /prisefillblock <ID> <X1> <Y1> <Z1> <X2> <Y2> <Z2>"));
            }
        } else {
        	sender.addChatMessage(new ChatComponentText("Syntaxe: /prisefillblock <ID> <X1> <Y1> <Z1> <X2> <Y2> <Z2>"));
        }
	}
	
    public boolean isNumber(final String prenum) {
        try {
            Integer.valueOf(prenum);
            return true;
        }
        catch (NumberFormatException e) {
            return false;
        }
    }
	
    
    @Override
    public int getRequiredPermissionLevel() {
    	return 0;
    }

}
