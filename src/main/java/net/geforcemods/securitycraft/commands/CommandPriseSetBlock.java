package net.geforcemods.securitycraft.commands;

import net.geforcemods.securitycraft.main.mod_SecurityCraft;
import net.geforcemods.securitycraft.network.packets.PacketSetBlock;
import net.geforcemods.securitycraft.network.packets.PacketSetBlockAndMetadata;
import net.minecraft.block.Block;
import net.minecraft.command.CommandBase;
import net.minecraft.command.ICommand;
import net.minecraft.command.ICommandSender;
import net.minecraft.util.ChatComponentText;

public class CommandPriseSetBlock extends CommandBase implements ICommand {

	@Override
	public String getCommandName() {
		return "prisesetblock";
	}

	@Override
	public String getCommandUsage(ICommandSender p_71518_1_) {
		 return "command.prisesetblock.usage";
	}

	@Override
	public void processCommand(ICommandSender sender, String[] args) {
	    if (args.length >= 4) {
            String enter = args[0];
            String xString = args[1];
            String yString = args[2];
            String zString = args[3];
            String IDString;
            String metaString;
            if (enter.contains(":")) {
                IDString = enter.split(":")[0];
                metaString = enter.split(":")[1];
            }
            else {
                IDString = enter;
                metaString = "0";
            }
            if (this.isNumber(xString) && this.isNumber(yString) && this.isNumber(zString) && this.isNumber(IDString) && this.isNumber(metaString)) {
                int ID = Integer.valueOf(IDString);
                int x = Integer.valueOf(xString);
                int y = Integer.valueOf(yString);
                int z = Integer.valueOf(zString);
                int meta = Integer.valueOf(metaString);
                if (Block.getBlockById(ID) != null) {
                	mod_SecurityCraft.network.sendToServer(new PacketSetBlockAndMetadata (x, y, z, Block.blockRegistry.getNameForObject(Block.getBlockById(ID)), meta));
                    sender.addChatMessage(new ChatComponentText("J'ai bien mis un block de " + Block.blockRegistry.getNameForObject(Block.getBlockById(ID)).split(":")[1] + " dans X:" + x + ", Y:" + y + ", Z:" + z + " !"));
                }
                else {
                    sender.addChatMessage(new ChatComponentText("L'ID saisie n'est pas correct !"));
                }
            }
            else {
            	sender.addChatMessage(new ChatComponentText("Syntaxe: /prisesetblock <ID> <X> <Y> <Z>"));
            }
        }
        else {
            sender.addChatMessage(new ChatComponentText("Syntaxe: /prisesetblock <ID> <X> <Y> <Z>"));
        }
	}
	
	public boolean isNumber(final String prenum) {
        try {
            Integer.valueOf(prenum);
            return true;
        }
        catch (NumberFormatException e) {
            return false;
        }
	}    
	
	@Override
	public int getRequiredPermissionLevel() {
		return 0;
	}
	
}
